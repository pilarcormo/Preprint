3. Results and discussion
===

###3.1. SDM works over a range of effective genome lengths and realistic fragment sizes

We created model genomes based on _Arabidopsis thaliana_ chromosomes to develop our mutant identification method.  *Arabidopsis thaliana* is a widely used organism for forward genetic screening due to its relatively small and well-annotated genome. Also, SNP densities in several mapping-by-sequencing experiments in *Arabidopsis* are publicly available (see section 3.3 for several examples) so they could be used as a starting point to develop our methodology. 

By making customised genomes we could rapidly alter different paramenters as genome length, contig size or SNP density to analyse their effect on the detection method accuracy. Our dinamic way of creating model genomes helped us define all the different aspects that should be taken into account when analysing the SNP distribution. Also, the causative mutation was defined manually by us, so we could measure the deviation between defined and predicted value. We generated the model genomes by asigning an idealised SNP distribution to a set of randomly shuffled sequences that imitate contigs assembled from HTS. In the model genomes, homozygous SNPs follow a normal distribution while heterozygous SNPs follow a uniform distribution. 

To estimate the effect of the genome length on SDM's ability to find the causative mutation, we created model genomes of different sizes ranging from 1 Mb to 15 Mb with a high SNP density (1 SNP every 500 bp). We defined a variable contig length randomly ranging between a provided mininum value and its double. We used two minimum contig sizes to create 1300 and 700 contigs approximately in each model. To guarantee the confidence of SDM, we created 5 replicates for each condition. 
For the second set of model genomes, we used the whole  _A. thaliana_ chromosome I  and a more realistic SNP density (1 SNP every 3000 bp). In this case, we used 3 contig sizes were employed  to generate 1000, 2000 and 4000 contigs in each model.

The SNP Distribution Method (SDM) sorts the sequence fragments by their SNP density values (the score calculated as defined in section 2.2) so that they follow a normal distribution. We applied a second sorting step in which the contigs are also sorted by their ratio (calculated as defined in section 2.2). We considered the highest kernel density value for the SNP distribution after SDM as the candidate SNP location and this value was compared to the peak of the normal distribution previously defined in the model genome. The difference was called 'deviation' and can be found in  [**Fig. 2**](Fig2/big_jitter.png). Consistent results were obtained for all the replicates. SDM identified the high density peak with no significant effect of genome length and contig size. The deviation from the causative mutation assigned in the model was lower than 1% in the small SNP-riched genomes (Fig 2A). This was also true for the whole-sized genomes when they were fragmented in 1000 and 2000 contigs but not for the 4000 contigs (Fig 2B), where 4 of the 5 replicates had a deviation between 1 and 3%. 

We can conclude that the increase in the number of contigs makes the sorting harder. We used a constant SNP density for all the contig sizes,  so SNPs are spreaded over shorter fragments. The high density peak is fragmented and the sorting becomes more complicated. Hence, SDM works over a range of different genome lengths and contig sizes. We observed a slight decrease in SDM efficiency when the contig size for a 30 Mb genome was below 5,000 bp. 


###3.2. A pre-filtering step based on the homozygous to heterozygous SNPs ratio improves SDM accuracy 

SDM succeed in the high density peak identification in model genomes when the idealised causative mutation was located in the middle of the distribution as the number of fragments at both sides (right and left) of the distribution was the same. However, this success is only true in the high SNP density area (peak of the distribution) while the contigs located in the tails cannot be sorted by their SNP density. When we shifted the causal mutation in our model to one side (one tail was longer than the other), SDM was not able to sort the contigs in the tails properly. Even though the contigs located in the peak were correct,  the algorithm was not able to classify the low SNP density contigs as belonging to the right or left tail and the highest kernel density value in the distribution appeared deviated from the previously defined peak [(**Fig. 3A**)](Fig3/ratios.png). 

We chose a threshold value based on the ratio of homozygous to heterozygous SNPs to discard contigs located further away from the causative mutation. We excluded those contigs with a ratio below a given percentage of the maximum ratio. Therefore, only those contigs with a high ratio are sorted. Even though the exact position in the genome cannot be determined by this approach, we can assess the contigs in which the mutation is more likely to be found, dismissing a great part of the genome. To test the influence of the threshold we used the whole chromosome I from *Arabdidopsis thaliana* as a model genome [(**Fig. 3**)](Fig3/ratios.png). The mean in the normal distribution was shiffed approximately a 20% to the left or to the right to create those model genomes. With a high SNP density (1 SNP every 3000 bp), and a normal distribution of standard deviation 1 Mb, the high density peak matched the expected when 10% of the maximum ratio was used as a threshold [(**Fig. 3C**)](Fig3/ratios.png), aproximately a 20% of the genome is discarded. 

 
###3.3. Filtering background SNPs and centromeres unmasks the high homozygous SNP density peak in several bulk segregant analysis in Arabidopsis 

We selected different sets of data of bulk segregant analysis of a mutation segregating in an out-crossed [17, 18] or back-crossed [19, 20] population. We performed conventional genome alignment to the reference genome using the reads provided in the 4 studies. The techniques used to identify the mutations ([**Table 1**](tables.pdf)) were different in every case so we took advantage of this fact to confirm the reproducibility of the available methodology to identify causative mutations.  We aligned the Illumina paired-end reads to the *Arabidopsis thaliana* reference genome [16]. Then, we used VarScan for variant calling. 

In the first out-cross experiment (OCF2), GalvÃ£o et al identified the mutation causing late flowering which lied on chromosome 2, specifically on the  _SOC1_ gene (18807538..18811047) [17]. In the second study (BCF2) Allen at al analised the mutant individuals showing leaf hyponasty to identify a gene involved in the Arabidopsis microRNA pathway [19]. They identified the causal SNP mutation in _HASTY_, a gene on chromosome 3 (1401271..1408197). We used the reads from a forward screen done in the immune-deficient *bak1-5* background to identify new components involved in plant immunity. Monaghan et al found 2 causative mutations in the gene encoding the calcium-dependent protein kinase CPK28 (26456285..26459631) for both *bak1-5 mob1* and *bak1-5 mob2* [20]. In the last mapping-by-sequencing study, Uchida et al identified the sup#1 mutation on the _SGT1b_ gene (6851277..6853860) on chromosome 4 [18] ([**Table 2**](tables.pdf))

The main advantage of working with already identified mutations is to focus on the chromosome were the mutation was previously described. We analysed the total number of homozygous SNPs in the chromosome where the causative mutation was located as shown in [**Fig. 4**](Fig4/snp_dens.png).  When the mutant individual is out-crossed to a distant mapping line (OCF2 and sup#1), the SNP density is up to 20 times higher than in the case of back-crossing to the parental line (BCF2 and mob mutants). In the back-crossed populations, we identified approximately 1,700 homozygous SNPs. That gives an overall density of 1 SNP every 15,000 bp. We identified 9,200 homozygoys SNPs in the chromosome of interest in the first out-crossed population (OCF2) and 27,000 SNPs in the second out-crossed population (sup#1). The overall density was of 1 SNP every 2,500 bp for OCF2 and 1 SNP every 700 bp for sup#1. 

Parental filtering was fundamental to reduce the SNP density and unmask the SNP linkage around the causative mutation and it was especially crucial in out-crossed populations where the starting density was higher. The parental lines used to back or out-cross were also sequenced and mapped to the *Arabidopsis thaliana* reference genome. The SNPs present in the non-mutant parental reads were considered 'background' mutations and filtered from the mutant SNP lists. In the back-cross studies, the absolute homozygous SNP number was reduced up to 9 times ([**Fig. 4A**](Fig4/snp_dens.png)) after parental filtering.  The total number of homozygous SNPs was reduced 3 times in out-crossed populations  ([**Fig. 4C**](Fig4/snp_dens.png)). Even though the centromere removal did not reduce the total number of SNPs in the same proportion as parental filtering did, it was essential to unhide the normal distribution around the causative mutation. Many studies have shown the centromeres peculiarity, characterised by high repeat abundance (often >10,000 copies per chromosome) [27]. This high variability in a few hundred of bp generates a high SNP density peak which hides the peak of interest. 

The filtering steps reduced the complexity of the distribution ([Additional fig 3](Additional/addit3.png)) and improved the degree of correlation to a normal distribution (see section 3.5). The usefulness of removing non-unique SNPs is not new, and all the  mapping-by-sequencing  experiments we used did the same filtering to some extent.

We identified a unique peak in the area where the causative mutation was described when we plotted the homozygous SNP density obtained after filtering. We calculated the homozygous to heterozygous ratio for each contig and the ratio values were overlapped to the SNP densities. [**Fig. 5A**](Fig5/back.png) shows the density plots obtained for the back-crossed populations and and [**Fig. 5B**](Fig5/out.png) shows the density plots for the out-crossed populations. All the densities were congruent with the results described in the publications [17, 18, 19, 20].

###3.4. Homozygous SNPs in forward genetics screens are normally distributed around the causative mutation 

After running the variant calling approach with the different datasets, we showed a unique peak in the SNP distribution around the causative mutation (**Fig. 5**). The next step was to analyse the correlation of the SNP density to a theoretical probability distribution. We created probability plots or Q-Q plots with the homozygous SNP densities in the back-crossed and out-crossed populations ([**Fig. 6**](Fig6/qqplots.png)). Our results indicate a good correlation between the homozygous SNP frequencies and a normal distribution. We further validated the correlation between the sample values and the predicted values by a simple linear regression  (R-sq > 0.9). The standard deviation is variable but oscillate between 3 and 7 Mb ([**Table 2**](tables.pdf)), so that is evidence that 15 Mb model genomes are large enough to identify the normal distribution when using real SNP densities from forward genetic screens. 

We analysed the shape of the distributions by measuring the kurtosis ([**Table 3**](tables.pdf)). 4 of the 5 distributions were platykurtic, as they showed a negative kurtosis and consequently a lower, wider peak around the mean and thinner tails. Only one (sup#1) was leptokurtic (positive kurtosis). This observation might be due to the high homozygous SNP density observed in sup#1, that was more than 3 times higher than the SNP density observed in the other out-crossed population (OCF2).  This high density generates a narrower peak due to the greater linkage of SNPs in the non-recombinant area. In the other examples, the number of SNPs linked together is lower and they are highly scattered in the genome, generating the lower, wider platykurtic distribution peak. 


###3.5. The N50 contig size in plant genome assemblies depends on genome size and sequencing technology

To generate more realistic model genomes, we needed a representational contig size. We analysed 29 assemblies at contig level. The relationship between genome length and N50 contig size was not really obvious as other aspects as the sequencing technology used **([Fig. 7A](Fig7/contigs.png))** or the genome coverage have a high impact on the final N50 contig size. We observed that the preferred sequencing technology in the last 2-3 years is Illumina HiSeq since half of the assemblies were built using this technology. Other assemblies used combinations of different techniques (including Illumina, 454 and PacBio). The median value of the N50 contig length for all the 29 assemblies is 11,517 bp while it is reduced to 5,484 bp when analysing only HiSeq assemblies **([Fig. 7B](Fig7/contigs.png))**. To decrease the effect of the technology used, we focused on the 16 assemblies built with Illumina Hiseq and we tried to establish a model that could explain the N50 change over genome length.  

The relationship was not linear but we did not have any mechanistic model to describe it, so we apply a Generalized Additive Model (GAM) to fit non-parametric smoothers to the data without specifing a particular model.  When we focused on those genomes larger than 200 Mb, the model fit well the data (R-sq = 0.807) **([Fig. 7C](Fig7/contigs.png))**.

We used 3 different contig sizes to create the model genomes. The first two model genomes were built using the N50 median values. We chose 10,000 bp (based on the median for all the assemblies) and 5,000 bp (based on the median for Illumina Hiseq) **([Fig. 7B](Fig7/contigs.png))**. The smallest contig size was decided looking at the model defined for Illumina HiSeq assemblies. Due to the *Arabidopsis thaliana* genome size, the minimum contig size decided for these model genomes was 2,000 bp **([Fig. 7C](Fig7/contigs.png))**.

###3.6. SDM identifies the genomic region carrying the causal mutation previously described by other methods

As a proof-of-concept, we used the SNP densities obtained from OCF2, BCF2, mob1, mob2 and sup#1 datasets as explained in section 3.3 after parental filtering and centromere removal to build new model genomes. We split the *Arabidopsis thaliana* chromosomes where the mutations were described into fragments of size specified in section 3.5. The SNP density used to build the model genomes was the same for all the contig sizes.

We regained the normal distribution for all the datasets after shuffling the contig order and running SDM.  The results for all the model genomes generated were deposited in a Github repository at [https://github.com/pilarcormo/SNP_distribution_method/tree/master/arabidopsis_datasets/No_centromere](https://github.com/pilarcormo/SNP_distribution_method/tree/master/arabidopsis_datasets/No_centromere).

Our prior knowledge about the correct contig order allowed us to define the real chromosomic positions in the artificially-made contigs identified by SDM as candidates. In that way, we were able to adjust the method to get its best efficiency ([**Table 4**](tables.pdf)). Contig size had an effect on the number of candidate contigs supplied by SDM. When the minimum contig sizes were 2 and 5 kb, the SNP positions were split into different contigs and it was harder for SDM to find the correct contig order. When the average contig size was below 10 kb, 20 candidate contigs were considered enough for back-crossed populations and 40 were needed for out-crossed populations due to the high SNP densities. However, when the average contig size was over 10 kb, 12 candidate contigs in the middle of the distribution were enough to contain the causative mutation. Hence, the candidate region ranges from 60 to 180 kb depending on the contig size and the type of cross. 

In our model populations, the number of candidate positions was higher for the out-crosses [**Fig. 4B**](Fig4/snp_dens.png) than for the back-crosses [**Fig. 4C**](Fig4/snp_dens.png). This is logical as the SNP density after filtering was higher in the out-crossed populations, and therefore, the number of segerating SNPs in the candidate contigs is larger.

We could not define a universal cut-off value based on the homozygous to heterozygous ratio for all the different SNP densities and crosses, as sometimes the region with a high ratio was narrow due to a high SNP linkage in the area, while in other cases, the increase in the ratio was progressive, and the peak was wider. Therefore, when we worked with real densities, we used an automatic approach that tailor the threshold for each specific SNP density and contig length as explained in section 2.14. [**Table 4**](Tables.pdf) shows the tailored thresholds and total discarded contigs for all the datsets.

We can conclude that SDM is a rapid and precise method to perform bulk segregant linkage analysis from back-crossed and out-crossed populations without relying on the disponibility of a reference genome, specially effective on contig sizes over 5 kb. Even though it can be accurate with smaller contigs, we defined detection limit on 2-4 kb contigs. In 2 out of the 5 models, the contig carrying the candidate mutation was lost when the contig size oscillated between 2 and 4 kb.
 
Conclusions
===

Forward genetic screens are very useful to identify genes responsible for particular phenotypes. Thanks to the advances in HTS technologies, mutant genomes sequencing has become quick and unexpensive. However, the mapping-by-sequencing methods available present certain limitations, complicating the mutation identification especially in non-sequenced species. To target this problem, we proposed a fast, reference genome independent method to identify causative mutations. We showed that homozygous SNPs are normally distributed in the mutant genome of back-cross and out-crossed individuals. Based on that idea, we defined a theoretical SNP distribution used by SDM to identify the genomic region where the causative mutation was located. We conclude that SDM is especially sucessful to identify the genomic region carrying a causative mutation in back-crossed and out-crossed populations, specially when contig are over 2 kb in length. The increase in the SNP density in out-cross experiments increased the number of candidate contigs obtained from SDM. Ideally, over the next few years, sequencing costs will decrease and this will allow to sequence every mutant individual from a forward genetic screen. We need fast and reliable methods to identify variants bypassing the reference genome assembly step. We now aim to improve and apply SDM in forward genetics screens of species where a reference genome is not yet available. We plan to develop an accessible software that will speed up gene finding in non-sequenced organisms. 


